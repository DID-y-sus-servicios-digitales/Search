<!DOCTYPE html>
<html>
<head>
    <title>Foto patata</title>
</head>
<body>
    <video id="video" width="640" height="480" autoplay></video>
    <button id="boton-foto">Tomar foto</button>
    <canvas id="canvas" width="640" height="480" style="display:none;"></canvas>
    <img id="foto" style="display:none;">

    <script>
        const video = document.getElementById('video');
        const botonFoto = document.getElementById('boton-foto');
        const canvas = document.getElementById('canvas');
        const foto = document.getElementById('foto');
        const contexto = canvas.getContext('2d');
        let stream;

        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(flujo => {
                    stream = flujo;
                    video.srcObject = flujo;

                    const reconocimiento = new webkitSpeechRecognition();
                    reconocimiento.lang = 'es-ES';

                    reconocimiento.onresult = evento => {
                        const transcripcion = evento.results[0][0].transcript.toLowerCase();
                        if (transcripcion.includes('patata')) {
                            tomarFoto();
                        }
                    };

                    reconocimiento.start();

                    botonFoto.onclick = tomarFoto;
                })
                .catch(error => {
                    console.error('Error al acceder a la cámara:', error);
                });
        } else {
            alert('La cámara no es compatible con este navegador.');
        }

        function tomarFoto() {
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            contexto.drawImage(video, 0, 0, canvas.width, canvas.height);
            const dataUrl = canvas.toDataURL('image/png');
            foto.src = dataUrl;
            foto.style.display = 'block';
        }
    </script>
</body>
</html>
