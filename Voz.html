<!DOCTYPE html>
<html>
<head>
    <title>Captura de fotos</title>
    <style>
        #camara {
            width: 640px;
            height: 480px;
            border: 1px solid black;
        }
        #fotos {
            display: flex;
            flex-wrap: wrap;
        }
        .foto-pequena {
            width: 100px;
            height: 100px;
            margin: 5px;
            border: 1px solid gray;
        }
    </style>
</head>
<body>
    <video id="camara" autoplay></video>
    <p id="texto-reconocido"></p>
    <button id="boton-foto">Haz la foto</button>
    <div id="fotos"></div>

    <script>
        const camara = document.getElementById('camara');
        const textoReconocido = document.getElementById('texto-reconocido');
        const botonFoto = document.getElementById('boton-foto');
        const fotos = document.getElementById('fotos');
        let recognition;

        // Acceder a la c치mara
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(stream => {
                camara.srcObject = stream;
            })
            .catch(error => {
                console.error('Error al acceder a la c치mara:', error);
            });

        // Reconocimiento de voz
        if ('webkitSpeechRecognition' in window) {
            recognition = new webkitSpeechRecognition();
            recognition.continuous = true;
            recognition.lang = 'es-ES';

            recognition.onresult = event => {
                const resultado = event.results[event.results.length - 1][0].transcript;
                textoReconocido.textContent = resultado;

                if (resultado.toLowerCase().includes('haz la foto') || resultado.toLowerCase().includes('patata')) {
                    tomarFoto();
                }
            };

            recognition.start();
        } else {
            textoReconocido.textContent = 'El reconocimiento de voz no est치 disponible en este navegador.';
        }

        // Tomar foto
        function tomarFoto() {
            const canvas = document.createElement('canvas');
            canvas.width = camara.videoWidth;
            canvas.height = camara.videoHeight;
            const contexto = canvas.getContext('2d');
            contexto.drawImage(camara, 0, 0, canvas.width, canvas.height);

            const fotoURL = canvas.toDataURL('image/png');
            mostrarFoto(fotoURL);
        }

        // Mostrar foto en miniatura
        function mostrarFoto(fotoURL) {
            const fotoPequena = document.createElement('img');
            fotoPequena.src = fotoURL;
            fotoPequena.classList.add('foto-pequena');

            fotoPequena.addEventListener('click', () => {
                descargarFoto(fotoURL);
            });

            fotos.appendChild(fotoPequena);
        }

        // Descargar foto
        function descargarFoto(fotoURL) {
            const enlaceDescarga = document.createElement('a');
            enlaceDescarga.href = fotoURL;
            enlaceDescarga.download = 'foto.png';
            enlaceDescarga.click();
        }

        // Tomar foto con el bot칩n
        botonFoto.addEventListener('click', tomarFoto);
    </script>
</body>
</html>
