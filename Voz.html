<!DOCTYPE html>
<html>
<head>
    <title>Asistente de voz</title>
</head>
<body>
    <p id="texto-reconocido"></p>

    <script>
        const textoReconocido = document.getElementById('texto-reconocido');
        let recognition;
        const synth = window.speechSynthesis;

        if ('webkitSpeechRecognition' in window) {
            recognition = new webkitSpeechRecognition();
            recognition.continuous = false;
            recognition.lang = 'es-ES';

            recognition.onresult = event => {
                const resultado = event.results[0][0].transcript.toLowerCase();
                textoReconocido.textContent = resultado;

                setTimeout(() => {
                    textoReconocido.textContent = '';
                }, 3000);

                responder(resultado);
            };

            recognition.start();
        } else {
            textoReconocido.textContent = 'El reconocimiento de voz no está disponible en este navegador.';
        }

        function responder(texto) {
            let respuesta = '';

            if (texto.includes('hola')) {
                respuesta = '¡Hola! ¿En qué puedo ayudarte?';
            } else if (texto.includes('qué hora es')) {
                const ahora = new Date();
                respuesta = `Son las ${ahora.getHours()} horas y ${ahora.getMinutes()} minutos.`;
            } else if (texto.includes('qué tiempo hace')) {
                obtenerTiempo()
                    .then(tiempo => {
                        const utterance = new SpeechSynthesisUtterance(tiempo);
                        utterance.lang = 'es-ES';
                        synth.speak(utterance);
                    })
                    .catch(error => {
                        const utterance = new SpeechSynthesisUtterance('Lo siento, no pude obtener la información del tiempo.');
                        utterance.lang = 'es-ES';
                        synth.speak(utterance);
                    });
                return; // Importante para evitar que se ejecute el resto del código
            } else if (texto.includes('cuéntame un chiste')) {
                respuesta = '¿Qué le dice un pez a otro? Nada.';
            } else if (texto.includes('cómo estás')) {
                respuesta = 'Como asistente virtual, no tengo sentimientos, pero estoy aquí para ayudarte.';
            } else if (texto.includes('qué día es hoy')) {
                const ahora = new Date();
                const dias = ['domingo', 'lunes', 'martes', 'miércoles', 'jueves', 'viernes', 'sábado'];
                respuesta = `Hoy es ${dias[ahora.getDay()]}.`;
            } else if (texto.includes('dime un número aleatorio')) {
                respuesta = `Aquí tienes un número aleatorio: ${Math.floor(Math.random() * 100)}.`;
            } else if (texto.includes('qué es javascript')) {
                respuesta = 'JavaScript es un lenguaje de programación utilizado para crear páginas web interactivas.';
            } else if (texto.includes('quién eres')) {
                respuesta = 'Soy un asistente virtual creado para ayudarte con tus tareas.';
            } else {
                respuesta = 'No entendí lo que dijiste. ¿Puedes repetirlo?';
            }

            const utterance = new SpeechSynthesisUtterance(respuesta);
            utterance.lang = 'es-ES';
            synth.speak(utterance);
        }

        async function obtenerTiempo() {
            try {
                const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=40.4167&longitude=-3.7033&current_weather=true');
                const data = await response.json();
                const temperatura = data.current_weather.temperature;
                return `La temperatura actual es de ${temperatura} grados Celsius.`;
            } catch (error) {
                console.error('Error al obtener el tiempo:', error);
                throw error;
            }
        }
    </script>
</body>
</html>
