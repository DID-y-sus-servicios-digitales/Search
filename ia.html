<!DOCTYPE html>
<html>
<head>
    <link rel="icon" type="image/png" sizes="16x16"  href="favicon-16x16.png">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffb8f2">
    <title>Asistente DID</title>
</head>
<body>
    <a href="index.html"><img src="Volver a DID search.png" width="19%" higth="19%"></a>
    <center>
    <h1>DID IA</h1>
    <h3>Este asistente, como está en desarrollo: cuando le escribas algo te pedirá la respuesta para guardar en nuestra base de datos</h3>
    <hr>
    <img src="Holaia.png" width="25%" higth="25%">
       <div id="chat-log"></div>
    <input type="text" id="user-input" placeholder="¿que te cuentas?" size="50">
    <button onclick="enviarMensaje()">Cuentamelo</button>
    </center>
        <script>
        import firebase from 'firebase/app';
import 'firebase/database';

const firebaseConfig = {
  apiKey: "AIzaSyAQnT9mTMvdFj-VY_fp5T7BdxQP6x6FpQ4",
  authDomain: "did-ia.firebaseapp.com",
  databaseURL: "https://did-ia-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "did-ia",
  storageBucket: "did-ia.firebasestorage.app",
  messagingSenderId: "980363277500",
  appId: "1:980363277500:web:c97380845d78257ae24cb9"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

fetch('respuestas.json')
  .then(response => response.json())
  .then(data => {
    const respuestas = data;

    function obtenerRespuesta(pregunta) {
      if (respuestas[pregunta]) {
        return respuestas[pregunta];
      } else {
        return "¿Cuál es la respuesta?";
      }
    }

    function aprenderRespuesta(pregunta, respuesta) {
      respuestas[pregunta] = respuesta;
      database.ref('respuestas').update({ [pregunta]: respuesta });
    }

    function enviarMensaje() {
      const userInput = document.getElementById("user-input");
      const chatLog = document.getElementById("chat-log");
      const pregunta = userInput.value;

      chatLog.innerHTML += `<p><strong>Tú:</strong> ${pregunta}</p>`;
      const respuesta = obtenerRespuesta(pregunta);
      chatLog.innerHTML += `<p><strong>Asistente:</strong> ${respuesta}</p>`;

      if (respuesta == "¿Cuál es la respuesta?") {
        const respuestaUsuario = prompt("¿Cuál es la respuesta?");
        if (respuestaUsuario) {
          aprenderRespuesta(pregunta, respuestaUsuario);
          chatLog.innerHTML += `<p><strong>Asistente:</strong> ¡Gracias! He aprendido la respuesta.</p>`;
        }
      }

      userInput.value = "";
    }

    // Sincronizar respuestas desde Firebase
    database.ref('respuestas').on('value', (snapshot) => {
      const data = snapshot.val();
      if (data) {
        Object.assign(respuestas, data); // Combinar respuestas de Firebase
      }
    });

  })
  .catch(error => {
    console.error('Error al cargar el archivo JSON:', error);
  });

    </script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</body>
</html>
